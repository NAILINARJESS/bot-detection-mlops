<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <title>Bot Detection ‚Äì MLOps</title>
    <style>
        body { font-family: Arial; background: #f4f6f8; padding: 30px; }
        form, .result { background: white; padding: 20px; max-width: 500px; border-radius: 8px; }
        form { box-shadow: 0 2px 8px rgba(0,0,0,.1); }
        label { display: block; margin-top: 10px; font-weight: bold; }
        input { width: 100%; padding: 6px; margin-top: 4px; }
        button { margin-top: 20px; width: 100%; padding: 10px; }
        .bot { color: red; font-weight: bold; }
        .human { color: green; font-weight: bold; }
        .error { color: red; }
    </style>
</head>
<body>

<h1>ü§ñ Bot Detection ‚Äì MLOps</h1>

<form id="predict-form">
    <label>Hour</label><input type="number" name="hour" required>
    <label>Day of Week</label><input type="number" name="day_of_week" required>
    <label>Action Code</label><input type="number" name="action_code" required>
    <label>Actions per Session</label><input type="number" name="actions_per_session" required>
    <label>Session Duration (sec)</label><input type="number" name="session_duration_sec" required>
    <label>Time Diff (sec)</label><input type="number" name="time_diff_sec" required>
    <label>Is Private IP</label><input type="number" name="is_private_ip" required>
    <label>Action</label><input type="text" name="action" required>
    <label>IP Address</label><input type="text" name="ip_address" required>
    <label>User Agent</label><input type="text" name="user_agent" required>
    <label>Device Type</label><input type="text" name="device_type" required>
    <label>Browser Family</label><input type="text" name="browser_family" required>
    <label>OS Family</label><input type="text" name="os_family" required>
    <label>Bot Type</label><input type="text" name="bot_type" required>
    <button type="submit">Pr√©dire</button>
</form>

<div class="result" id="result"></div>

<script>
const form = document.getElementById("predict-form");
const resultDiv = document.getElementById("result");

form.addEventListener("submit", async (e) => {
    e.preventDefault();
    resultDiv.innerHTML = "‚è≥ Pr√©diction en cours...";

    const formData = new FormData(form);
    const features = {};
    formData.forEach((value, key) => {
        features[key] = isNaN(value) ? value : Number(value);
    });

    try {
        const response = await fetch("http://localhost:8000/predict", {
            method: "POST",
            headers: { "Content-Type": "application/json" },
            body: JSON.stringify({ features })
        });

        if (!response.ok) throw new Error(await response.text());

        const data = await response.json();
        const label = data.prediction === 1 ? "BOT ü§ñ" : "HUMAIN üë§";
        const css = data.prediction === 1 ? "bot" : "human";

        resultDiv.innerHTML = `
            <p class="${css}">${label}</p>
            <p>Probabilit√© BOT : ${(data.probability * 100).toFixed(2)}%</p>
        `;
    } catch (err) {
        resultDiv.innerHTML = `<p class="error">‚ùå ${err.message}</p>`;
    }
});
</script>

</body>
</html>
